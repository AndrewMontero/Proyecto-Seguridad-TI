<!DOCTYPE html>
<html>
<head>
<title>README.md</title>
<meta http-equiv="Content-type" content="text/html;charset=UTF-8">

<style>
/* https://github.com/microsoft/vscode/blob/master/extensions/markdown-language-features/media/markdown.css */
/*---------------------------------------------------------------------------------------------
 *  Copyright (c) Microsoft Corporation. All rights reserved.
 *  Licensed under the MIT License. See License.txt in the project root for license information.
 *--------------------------------------------------------------------------------------------*/

body {
	font-family: var(--vscode-markdown-font-family, -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif);
	font-size: var(--vscode-markdown-font-size, 14px);
	padding: 0 26px;
	line-height: var(--vscode-markdown-line-height, 22px);
	word-wrap: break-word;
}

#code-csp-warning {
	position: fixed;
	top: 0;
	right: 0;
	color: white;
	margin: 16px;
	text-align: center;
	font-size: 12px;
	font-family: sans-serif;
	background-color:#444444;
	cursor: pointer;
	padding: 6px;
	box-shadow: 1px 1px 1px rgba(0,0,0,.25);
}

#code-csp-warning:hover {
	text-decoration: none;
	background-color:#007acc;
	box-shadow: 2px 2px 2px rgba(0,0,0,.25);
}

body.scrollBeyondLastLine {
	margin-bottom: calc(100vh - 22px);
}

body.showEditorSelection .code-line {
	position: relative;
}

body.showEditorSelection .code-active-line:before,
body.showEditorSelection .code-line:hover:before {
	content: "";
	display: block;
	position: absolute;
	top: 0;
	left: -12px;
	height: 100%;
}

body.showEditorSelection li.code-active-line:before,
body.showEditorSelection li.code-line:hover:before {
	left: -30px;
}

.vscode-light.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(0, 0, 0, 0.15);
}

.vscode-light.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(0, 0, 0, 0.40);
}

.vscode-light.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-dark.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 255, 255, 0.4);
}

.vscode-dark.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 255, 255, 0.60);
}

.vscode-dark.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

.vscode-high-contrast.showEditorSelection .code-active-line:before {
	border-left: 3px solid rgba(255, 160, 0, 0.7);
}

.vscode-high-contrast.showEditorSelection .code-line:hover:before {
	border-left: 3px solid rgba(255, 160, 0, 1);
}

.vscode-high-contrast.showEditorSelection .code-line .code-line:hover:before {
	border-left: none;
}

img {
	max-width: 100%;
	max-height: 100%;
}

a {
	text-decoration: none;
}

a:hover {
	text-decoration: underline;
}

a:focus,
input:focus,
select:focus,
textarea:focus {
	outline: 1px solid -webkit-focus-ring-color;
	outline-offset: -1px;
}

hr {
	border: 0;
	height: 2px;
	border-bottom: 2px solid;
}

h1 {
	padding-bottom: 0.3em;
	line-height: 1.2;
	border-bottom-width: 1px;
	border-bottom-style: solid;
}

h1, h2, h3 {
	font-weight: normal;
}

table {
	border-collapse: collapse;
}

table > thead > tr > th {
	text-align: left;
	border-bottom: 1px solid;
}

table > thead > tr > th,
table > thead > tr > td,
table > tbody > tr > th,
table > tbody > tr > td {
	padding: 5px 10px;
}

table > tbody > tr + tr > td {
	border-top: 1px solid;
}

blockquote {
	margin: 0 7px 0 5px;
	padding: 0 16px 0 10px;
	border-left-width: 5px;
	border-left-style: solid;
}

code {
	font-family: Menlo, Monaco, Consolas, "Droid Sans Mono", "Courier New", monospace, "Droid Sans Fallback";
	font-size: 1em;
	line-height: 1.357em;
}

body.wordWrap pre {
	white-space: pre-wrap;
}

pre:not(.hljs),
pre.hljs code > div {
	padding: 16px;
	border-radius: 3px;
	overflow: auto;
}

pre code {
	color: var(--vscode-editor-foreground);
	tab-size: 4;
}

/** Theming */

.vscode-light pre {
	background-color: rgba(220, 220, 220, 0.4);
}

.vscode-dark pre {
	background-color: rgba(10, 10, 10, 0.4);
}

.vscode-high-contrast pre {
	background-color: rgb(0, 0, 0);
}

.vscode-high-contrast h1 {
	border-color: rgb(0, 0, 0);
}

.vscode-light table > thead > tr > th {
	border-color: rgba(0, 0, 0, 0.69);
}

.vscode-dark table > thead > tr > th {
	border-color: rgba(255, 255, 255, 0.69);
}

.vscode-light h1,
.vscode-light hr,
.vscode-light table > tbody > tr + tr > td {
	border-color: rgba(0, 0, 0, 0.18);
}

.vscode-dark h1,
.vscode-dark hr,
.vscode-dark table > tbody > tr + tr > td {
	border-color: rgba(255, 255, 255, 0.18);
}

</style>

<style>
/* Tomorrow Theme */
/* http://jmblog.github.com/color-themes-for-google-code-highlightjs */
/* Original theme - https://github.com/chriskempson/tomorrow-theme */

/* Tomorrow Comment */
.hljs-comment,
.hljs-quote {
	color: #8e908c;
}

/* Tomorrow Red */
.hljs-variable,
.hljs-template-variable,
.hljs-tag,
.hljs-name,
.hljs-selector-id,
.hljs-selector-class,
.hljs-regexp,
.hljs-deletion {
	color: #c82829;
}

/* Tomorrow Orange */
.hljs-number,
.hljs-built_in,
.hljs-builtin-name,
.hljs-literal,
.hljs-type,
.hljs-params,
.hljs-meta,
.hljs-link {
	color: #f5871f;
}

/* Tomorrow Yellow */
.hljs-attribute {
	color: #eab700;
}

/* Tomorrow Green */
.hljs-string,
.hljs-symbol,
.hljs-bullet,
.hljs-addition {
	color: #718c00;
}

/* Tomorrow Blue */
.hljs-title,
.hljs-section {
	color: #4271ae;
}

/* Tomorrow Purple */
.hljs-keyword,
.hljs-selector-tag {
	color: #8959a8;
}

.hljs {
	display: block;
	overflow-x: auto;
	color: #4d4d4c;
	padding: 0.5em;
}

.hljs-emphasis {
	font-style: italic;
}

.hljs-strong {
	font-weight: bold;
}
</style>

<style>
/*
 * Markdown PDF CSS
 */

 body {
	font-family: -apple-system, BlinkMacSystemFont, "Segoe WPC", "Segoe UI", "Ubuntu", "Droid Sans", sans-serif, "Meiryo";
	padding: 0 12px;
}

pre {
	background-color: #f8f8f8;
	border: 1px solid #cccccc;
	border-radius: 3px;
	overflow-x: auto;
	white-space: pre-wrap;
	overflow-wrap: break-word;
}

pre:not(.hljs) {
	padding: 23px;
	line-height: 19px;
}

blockquote {
	background: rgba(127, 127, 127, 0.1);
	border-color: rgba(0, 122, 204, 0.5);
}

.emoji {
	height: 1.4em;
}

code {
	font-size: 14px;
	line-height: 19px;
}

/* for inline code */
:not(pre):not(.hljs) > code {
	color: #C9AE75; /* Change the old color so it seems less like an error */
	font-size: inherit;
}

/* Page Break : use <div class="page"/> to insert page break
-------------------------------------------------------- */
.page {
	page-break-after: always;
}

</style>

<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
</head>
<body>
  <script>
    mermaid.initialize({
      startOnLoad: true,
      theme: document.body.classList.contains('vscode-dark') || document.body.classList.contains('vscode-high-contrast')
          ? 'dark'
          : 'default'
    });
  </script>
<h1 id="%F0%9F%8C%BE-agrosenso-lite">ğŸŒ¾ AgroSenso Lite</h1>
<p>Sistema de gestiÃ³n agrÃ­cola con demostraciÃ³n de vulnerabilidades OWASP Top 10 2021</p>
<p><img src="https://img.shields.io/badge/Laravel-11-red?style=flat&amp;logo=laravel" alt="Laravel">
<img src="https://img.shields.io/badge/PHP-8.2-blue?style=flat&amp;logo=php" alt="PHP">
<img src="https://img.shields.io/badge/MySQL-8.0-orange?style=flat&amp;logo=mysql" alt="MySQL">
<img src="https://img.shields.io/badge/OWASP-Top 10 2021-purple?style=flat" alt="OWASP"></p>
<hr>
<h2 id="%F0%9F%93%8B-tabla-de-contenidos">ğŸ“‹ Tabla de Contenidos</h2>
<ol>
<li><a href="#-descripci%C3%B3n-del-proyecto">DescripciÃ³n del Proyecto</a></li>
<li><a href="#-requisitos-del-sistema">Requisitos del Sistema</a></li>
<li><a href="#-instalaci%C3%B3n">InstalaciÃ³n</a></li>
<li><a href="#-vulnerabilidades-implementadas">Vulnerabilidades Implementadas</a></li>
<li><a href="#-estructura-del-proyecto">Estructura del Proyecto</a></li>
<li><a href="#-uso-y-demostraci%C3%B3n">Uso y DemostraciÃ³n</a></li>
<li><a href="#-cr%C3%A9ditos">CrÃ©ditos</a></li>
</ol>
<hr>
<h2 id="%F0%9F%93%96-descripci%C3%B3n-del-proyecto">ğŸ“– DescripciÃ³n del Proyecto</h2>
<p><strong>AgroSenso Lite</strong> es un sistema de gestiÃ³n agrÃ­cola desarrollado en Laravel que permite:</p>
<ul>
<li>ğŸ“Š Dashboard con mÃ©tricas agrÃ­colas</li>
<li>ğŸŒ± GestiÃ³n de parcelas (CRUD completo)</li>
<li>ğŸ“¦ CatÃ¡logo de productos agrÃ­colas</li>
<li>ğŸ“¡ Registro de lecturas de sensores (simuladas)</li>
<li>ğŸ” Sistema de autenticaciÃ³n</li>
</ul>
<p>Este proyecto fue creado con <strong>propÃ³sitos educativos</strong> para demostrar las <strong>6 vulnerabilidades mÃ¡s crÃ­ticas</strong> del OWASP Top 10 2021 en una aplicaciÃ³n web real.</p>
<hr>
<h2 id="%F0%9F%94%A7-requisitos-del-sistema">ğŸ”§ Requisitos del Sistema</h2>
<p>Antes de instalar, asegÃºrate de tener:</p>
<ul>
<li><strong>PHP</strong> &gt;= 8.2</li>
<li><strong>Composer</strong> &gt;= 2.6</li>
<li><strong>MySQL</strong> &gt;= 8.0</li>
<li><strong>Node.js</strong> &gt;= 18 (opcional, para assets)</li>
<li><strong>Git</strong></li>
</ul>
<h3 id="verificar-instalaciones">Verificar instalaciones:</h3>
<pre class="hljs"><code><div>php --version
composer --version
mysql --version
</div></code></pre>
<hr>
<h2 id="%E2%9A%99%EF%B8%8F-instalaci%C3%B3n">âš™ï¸ InstalaciÃ³n</h2>
<h3 id="1%EF%B8%8F%E2%83%A3-clonar-el-repositorio">1ï¸âƒ£ Clonar el repositorio</h3>
<pre class="hljs"><code><div>git <span class="hljs-built_in">clone</span> https://github.com/AndrewMontero/Proyecto-Seguridad-TI.git
<span class="hljs-built_in">cd</span> Proyecto-Seguridad-TI
</div></code></pre>
<h3 id="2%EF%B8%8F%E2%83%A3-instalar-dependencias-de-php">2ï¸âƒ£ Instalar dependencias de PHP</h3>
<pre class="hljs"><code><div>composer install
</div></code></pre>
<h3 id="3%EF%B8%8F%E2%83%A3-configurar-variables-de-entorno">3ï¸âƒ£ Configurar variables de entorno</h3>
<p>Copia el archivo <code>.env.example</code> y renÃ³mbralo a <code>.env</code>:</p>
<pre class="hljs"><code><div>cp .env.example .env
</div></code></pre>
<p>O en Windows:</p>
<pre class="hljs"><code><div><span class="hljs-built_in">copy</span> .env.example .env
</div></code></pre>
<p>Edita el archivo <code>.env</code> con tus credenciales:</p>
<pre class="hljs"><code><div><span class="hljs-attr">APP_NAME</span>=<span class="hljs-string">AgroSenso</span>
<span class="hljs-attr">APP_ENV</span>=<span class="hljs-string">local</span>
<span class="hljs-attr">APP_DEBUG</span>=<span class="hljs-string">true</span>
<span class="hljs-attr">APP_URL</span>=<span class="hljs-string">http://localhost</span>

<span class="hljs-attr">DB_CONNECTION</span>=<span class="hljs-string">mysql</span>
<span class="hljs-attr">DB_HOST</span>=<span class="hljs-string">127.0.0.1</span>
<span class="hljs-attr">DB_PORT</span>=<span class="hljs-string">3306</span>
<span class="hljs-attr">DB_DATABASE</span>=<span class="hljs-string">agrosenso_db</span>
<span class="hljs-attr">DB_USERNAME</span>=<span class="hljs-string">root</span>
<span class="hljs-attr">DB_PASSWORD</span>=<span class="hljs-string">tu_password</span>
</div></code></pre>
<h3 id="4%EF%B8%8F%E2%83%A3-generar-clave-de-aplicaci%C3%B3n">4ï¸âƒ£ Generar clave de aplicaciÃ³n</h3>
<pre class="hljs"><code><div>php artisan key:generate
</div></code></pre>
<h3 id="5%EF%B8%8F%E2%83%A3-crear-base-de-datos">5ï¸âƒ£ Crear base de datos</h3>
<p>Accede a MySQL:</p>
<pre class="hljs"><code><div>mysql -u root -p
</div></code></pre>
<p>Ejecuta:</p>
<pre class="hljs"><code><div><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">DATABASE</span> agrosenso_db <span class="hljs-built_in">CHARACTER</span> <span class="hljs-keyword">SET</span> utf8mb4 <span class="hljs-keyword">COLLATE</span> utf8mb4_unicode_ci;
EXIT;
</div></code></pre>
<h3 id="6%EF%B8%8F%E2%83%A3-ejecutar-migraciones">6ï¸âƒ£ Ejecutar migraciones</h3>
<pre class="hljs"><code><div>php artisan migrate
</div></code></pre>
<h3 id="7%EF%B8%8F%E2%83%A3-poblar-base-de-datos-con-datos-de-prueba">7ï¸âƒ£ Poblar base de datos con datos de prueba</h3>
<pre class="hljs"><code><div>php artisan db:seed --class=DemoSeeder
</div></code></pre>
<p>Esto crearÃ¡:</p>
<ul>
<li>âœ… 3 usuarios de prueba</li>
<li>âœ… 6 parcelas</li>
<li>âœ… 6 productos</li>
</ul>
<h3 id="8%EF%B8%8F%E2%83%A3-iniciar-servidor-de-desarrollo">8ï¸âƒ£ Iniciar servidor de desarrollo</h3>
<pre class="hljs"><code><div>php artisan serve
</div></code></pre>
<p>Accede a: <strong>http://127.0.0.1:8000</strong></p>
<hr>
<h2 id="%F0%9F%94%91-credenciales-de-acceso">ğŸ”‘ Credenciales de Acceso</h2>
<h3 id="usuarios-de-prueba">Usuarios de prueba:</h3>
<table>
<thead>
<tr>
<th>Email</th>
<th>Password</th>
<th>Rol</th>
</tr>
</thead>
<tbody>
<tr>
<td>josue@gmail.com</td>
<td>admin123</td>
<td>Usuario</td>
</tr>
<tr>
<td>maria@gmail.com</td>
<td>admin123</td>
<td>Usuario</td>
</tr>
<tr>
<td>carlos@gmail.com</td>
<td>admin123</td>
<td>Usuario</td>
</tr>
</tbody>
</table>
<hr>
<h2 id="%F0%9F%94%93-vulnerabilidades-implementadas">ğŸ”“ Vulnerabilidades Implementadas</h2>
<p>Este proyecto incluye <strong>6 vulnerabilidades crÃ­ticas</strong> del OWASP Top 10 2021:</p>
<hr>
<h3 id="1-%F0%9F%94%B4-broken-access-control-idor---a012021">1. ğŸ”´ <strong>Broken Access Control (IDOR)</strong> - A01:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>app/Http/Controllers/ParcelController.php</code> - LÃ­neas 26 y 39</p>
<p><strong>DescripciÃ³n:</strong><br>
Los mÃ©todos <code>edit()</code> y <code>update()</code> NO verifican que el usuario sea el propietario de la parcela antes de permitir acceso.</p>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">edit</span><span class="hljs-params">($id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    <span class="hljs-comment">// âŒ VULNERABLE: NO verifica ownership</span>
    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'parcels.edit'</span>, compact(<span class="hljs-string">'parcel'</span>));
}

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">(Request $request, $id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    <span class="hljs-comment">// âŒ VULNERABLE: NO hay verificaciÃ³n de propietario ni autorizaciÃ³n</span>
    $parcel-&gt;name = $request-&gt;input(<span class="hljs-string">'name'</span>);
    <span class="hljs-comment">// ... actualiza sin verificar</span>
}
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>ğŸš¨ Un usuario puede editar parcelas de otros usuarios</li>
<li>ğŸš¨ Acceso no autorizado a informaciÃ³n privada</li>
<li>ğŸš¨ ModificaciÃ³n o eliminaciÃ³n de datos ajenos</li>
<li>ğŸš¨ ViolaciÃ³n de la privacidad</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<ol>
<li>Inicia sesiÃ³n como <code>josue@gmail.com</code></li>
<li>Crea o identifica una parcela (ej: ID=1)</li>
<li>Cierra sesiÃ³n e inicia con <code>maria@gmail.com</code></li>
<li>Cambia la URL manualmente a: <code>/parcels/1/edit</code></li>
<li>Â¡Puedes editar la parcela de Josue sin ser el dueÃ±o!</li>
</ol>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">edit</span><span class="hljs-params">($id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    
    <span class="hljs-comment">// âœ… Verificar propiedad</span>
    <span class="hljs-keyword">if</span> ($parcel-&gt;user_id !== Auth::id()) {
        abort(<span class="hljs-number">403</span>, <span class="hljs-string">'No autorizado'</span>);
    }
    
    <span class="hljs-keyword">return</span> view(<span class="hljs-string">'parcels.edit'</span>, compact(<span class="hljs-string">'parcel'</span>));
}
</div></code></pre>
<hr>
<h3 id="2-%F0%9F%94%B4-cross-site-scripting-xss---a032021">2. ğŸ”´ <strong>Cross-Site Scripting (XSS)</strong> - A03:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>app/Http/Controllers/ProductoController.php</code> - LÃ­nea 28</p>
<p><strong>DescripciÃ³n:</strong><br>
Los datos ingresados no se validan ni sanitizan antes de almacenarse, y se renderizan sin escapar en las vistas.</p>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div>DB::insert(<span class="hljs-string">"INSERT INTO productos (nombre, descripcion, precio, created_at, updated_at) 
            VALUES (?, ?, ?, NOW(), NOW())"</span>,
            [$request-&gt;nombre, $request-&gt;descripcion, $request-&gt;precio]
);
</div></code></pre>
<p>Vista vulnerable en <code>resources/views/productos/index.blade.php</code>:</p>
<pre class="hljs"><code><div>{!! $producto-&gt;descripcion !!}  &lt;!-- âŒ NO escapa HTML --&gt;
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>ğŸš¨ Robo de cookies y sesiones</li>
<li>ğŸš¨ Redireccionamiento a sitios maliciosos</li>
<li>ğŸš¨ ModificaciÃ³n del contenido de la pÃ¡gina</li>
<li>ğŸš¨ Captura de credenciales (keylogging)</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<ol>
<li>Ve a <code>/productos/crear</code></li>
<li>En el campo <strong>DescripciÃ³n</strong>, ingresa:</li>
</ol>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="actionscript">alert(<span class="hljs-string">'XSS Vulnerable!'</span>)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
</div></code></pre>
<ol start="3">
<li>Guarda el producto</li>
<li>Al ver la lista de productos, el script se ejecuta</li>
</ol>
<p><strong>Payloads de prueba:</strong></p>
<pre class="hljs"><code><div><span class="hljs-tag">&lt;<span class="hljs-name">script</span>&gt;</span><span class="javascript">alert(<span class="hljs-built_in">document</span>.cookie)</span><span class="hljs-tag">&lt;/<span class="hljs-name">script</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">img</span> <span class="hljs-attr">src</span>=<span class="hljs-string">x</span> <span class="hljs-attr">onerror</span>=<span class="hljs-string">"alert('XSS')"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">svg</span> <span class="hljs-attr">onload</span>=<span class="hljs-string">"alert('XSS')"</span>&gt;</span>
<span class="hljs-tag">&lt;<span class="hljs-name">iframe</span> <span class="hljs-attr">src</span>=<span class="hljs-string">"javascript:alert('XSS')"</span>&gt;</span>
</div></code></pre>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// En la vista, usar {{ }} en lugar de {!! !!}</span>
{{ $producto-&gt;descripcion }}  &lt;!-- âœ… Escapa automÃ¡ticamente --&gt;
</div></code></pre>
<hr>
<h3 id="3-%F0%9F%94%B4-security-misconfiguration---a052021">3. ğŸ”´ <strong>Security Misconfiguration</strong> - A05:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>routes/web.php</code> - LÃ­neas 111-126 y archivo <code>.env</code></p>
<p><strong>DescripciÃ³n:</strong><br>
MÃºltiples configuraciones inseguras:</p>
<ul>
<li>âŒ <code>APP_DEBUG=true</code> en &quot;producciÃ³n&quot;</li>
<li>âŒ Endpoint <code>/demo/leak-env</code> expone el archivo <code>.env</code></li>
<li>âŒ Stack traces detallados revelan estructura del sistema</li>
<li>âŒ Sin cabeceras de seguridad HTTP</li>
</ul>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div>Route::get(<span class="hljs-string">'/demo/leak-env'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Request $request)</span> </span>{
    <span class="hljs-comment">// âŒ Expone archivo .env si APP_DEBUG=true</span>
    <span class="hljs-keyword">if</span> (config(<span class="hljs-string">'app.debug'</span>) !== <span class="hljs-keyword">true</span>) {
        abort(<span class="hljs-number">404</span>);
    }
    
    $envPath = base_path(<span class="hljs-string">'.env'</span>);
    $content = file_get_contents($envPath);
    <span class="hljs-keyword">return</span> response($content, <span class="hljs-number">200</span>);
});
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>ğŸš¨ ExposiciÃ³n de credenciales (DB, API keys)</li>
<li>ğŸš¨ RevelaciÃ³n de estructura del sistema</li>
<li>ğŸš¨ InformaciÃ³n sobre versiones de software</li>
<li>ğŸš¨ Facilita otros ataques</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<p><strong>Ataque 1: Leer .env</strong></p>
<pre class="hljs"><code><div>http://127.0.0.1:8000/demo/leak-env
</div></code></pre>
<p>Resultado: Expone credenciales de base de datos, API keys, etc.</p>
<p><strong>Ataque 2: Forzar error para ver stack trace</strong></p>
<pre class="hljs"><code><div>http://127.0.0.1:8000/parcels/999999999
</div></code></pre>
<p>Resultado: Stack trace completo con:</p>
<ul>
<li>Rutas absolutas del servidor</li>
<li>Versiones de Laravel, PHP, MySQL</li>
<li>Queries SQL ejecutadas</li>
<li>Estructura de tablas</li>
</ul>
<p><strong>Ataque 3: Detectar tecnologÃ­as</strong></p>
<pre class="hljs"><code><div>curl -I http://127.0.0.1:8000
<span class="hljs-comment"># Headers revelan:</span>
<span class="hljs-comment"># X-Powered-By: PHP/8.2</span>
<span class="hljs-comment"># Server: Apache/2.4.52</span>
</div></code></pre>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div># En producciÃ³n
APP_DEBUG=false
APP_ENV=production

# Eliminar endpoints de debug
# - /demo/leak-env
# - /phpinfo
# - /debug

# Agregar cabeceras de seguridad
# En middleware:
$response-&gt;headers-&gt;set('X-Frame-Options', 'SAMEORIGIN');
$response-&gt;headers-&gt;set('X-Content-Type-Options', 'nosniff');
$response-&gt;headers-&gt;set('X-XSS-Protection', '1; mode=block');
</div></code></pre>
<hr>
<h3 id="4-%F0%9F%94%B4-broken-authentication---a072021">4. ğŸ”´ <strong>Broken Authentication</strong> - A07:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>routes/web.php</code> - LÃ­neas 158-170</p>
<p><strong>DescripciÃ³n:</strong><br>
El sistema de autenticaciÃ³n permite:</p>
<ul>
<li>âŒ ContraseÃ±as dÃ©biles sin requisitos de complejidad</li>
<li>âŒ Tokens de reset predecibles</li>
<li>âŒ Sin lÃ­mite de intentos de login (fuerza bruta)</li>
<li>âŒ Mensajes que revelan si un usuario existe</li>
</ul>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div>Route::post(<span class="hljs-string">'/demo-login'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Request $r)</span> </span>{
    $email = $r-&gt;post(<span class="hljs-string">'email'</span>);
    $password = $r-&gt;post(<span class="hljs-string">'password'</span>);

    $user = \App\Models\User::where(<span class="hljs-string">'email'</span>, $email)-&gt;first();
    
    <span class="hljs-comment">// âŒ Acepta contraseÃ±a dÃ©bil "admin123" para cualquier usuario</span>
    <span class="hljs-keyword">if</span> ($user &amp;&amp; $password === <span class="hljs-string">'admin123'</span>) {
        Auth::login($user);
        <span class="hljs-keyword">return</span> redirect(<span class="hljs-string">'/dashboard'</span>);
    }

    <span class="hljs-keyword">return</span> back()-&gt;with(<span class="hljs-string">'error'</span>, <span class="hljs-string">'Invalid demo credentials'</span>);
});
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>ğŸš¨ Ataques de fuerza bruta sin restricciÃ³n</li>
<li>ğŸš¨ EnumeraciÃ³n de usuarios vÃ¡lidos</li>
<li>ğŸš¨ AdivinaciÃ³n de tokens de reset</li>
<li>ğŸš¨ Cuentas vulnerables a takeover</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<p><strong>Ataque 1: ContraseÃ±a dÃ©bil universal</strong></p>
<ul>
<li>Cualquier usuario puede acceder con <code>admin123</code></li>
<li>No hay requisitos de complejidad de contraseÃ±a</li>
</ul>
<p><strong>Ataque 2: Token predecible</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// El token se genera como: md5(email + floor(time() / 600))</span>
<span class="hljs-comment">// Ruta: /demo-reset-request</span>
POST email=test@test.com
<span class="hljs-comment">// Resultado: Token predecible que puede ser adivinado</span>
</div></code></pre>
<p><strong>Ataque 3: Fuerza bruta sin lÃ­mite</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># Intentos ilimitados sin bloqueo</span>
curl -X POST http://127.0.0.1:8000/demo-login -d <span class="hljs-string">"email=josue@gmail.com&amp;password=test1"</span>
curl -X POST http://127.0.0.1:8000/demo-login -d <span class="hljs-string">"email=josue@gmail.com&amp;password=test2"</span>
<span class="hljs-comment"># ... sin lÃ­mite de intentos</span>
</div></code></pre>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Validar complejidad de contraseÃ±a</span>
<span class="hljs-string">'password'</span> =&gt; <span class="hljs-string">'required|min:8|regex:/[A-Z]/|regex:/[0-9]/'</span>

<span class="hljs-comment">// 2. Usar Hash::make() para contraseÃ±as</span>
Hash::make($password)

<span class="hljs-comment">// 3. Rate limiting</span>
RateLimiter::hit(<span class="hljs-string">'login:'</span> . $request-&gt;ip(), <span class="hljs-number">60</span>);

<span class="hljs-comment">// 4. Mensajes genÃ©ricos</span>
<span class="hljs-keyword">return</span> back()-&gt;with(<span class="hljs-string">'error'</span>, <span class="hljs-string">'Credenciales incorrectas'</span>);
</div></code></pre>
<hr>
<h3 id="5-%F0%9F%94%B4-security-logging-and-monitoring-failures---a092021">5. ğŸ”´ <strong>Security Logging and Monitoring Failures</strong> - A09:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>app/Http/Controllers/ParcelController.php</code> - LÃ­neas 40, 60, 72</p>
<p><strong>DescripciÃ³n:</strong><br>
El sistema NO registra eventos crÃ­ticos de seguridad:</p>
<ul>
<li>âŒ No registra quiÃ©n accede a quÃ© parcelas</li>
<li>âŒ No registra modificaciones (valores anteriores vs nuevos)</li>
<li>âŒ No registra eliminaciones de datos</li>
<li>âŒ No hay timestamps ni IP del usuario</li>
<li>âŒ Sin alertas de actividad sospechosa</li>
</ul>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div><span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">(Request $request, $id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    
    <span class="hljs-comment">// Actualiza sin registrar quiÃ©n, quÃ©, cuÃ¡ndo</span>
    $parcel-&gt;name = $request-&gt;input(<span class="hljs-string">'name'</span>);
    $parcel-&gt;save();
    
    <span class="hljs-comment">// âŒ VULNERABLE: NO hay log de auditorÃ­a</span>
    <span class="hljs-keyword">return</span> redirect()-&gt;route(<span class="hljs-string">'parcels.index'</span>);
}

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">destroy</span><span class="hljs-params">($id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    $parcel-&gt;delete();
    
    <span class="hljs-comment">// âŒ VULNERABLE: EliminaciÃ³n sin rastro</span>
    <span class="hljs-comment">// No hay forma de saber quiÃ©n lo eliminÃ³ ni recuperar los datos</span>
    <span class="hljs-keyword">return</span> redirect()-&gt;route(<span class="hljs-string">'parcels.index'</span>);
}
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>ğŸš¨ Atacantes actÃºan sin ser detectados</li>
<li>ğŸš¨ Imposible rastrear cambios maliciosos</li>
<li>ğŸš¨ No se pueden recuperar datos eliminados</li>
<li>ğŸš¨ Sin evidencia para investigaciones forenses</li>
<li>ğŸš¨ Incumplimiento de regulaciones (GDPR, SOC2)</li>
<li>ğŸš¨ Brechas de seguridad se descubren tarde</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<p><strong>Escenario de ataque:</strong></p>
<ol>
<li>Login como <code>josue@gmail.com</code> â†’ password: <code>admin123</code></li>
<li>Crear parcela &quot;Parcela Importante&quot;</li>
<li>Anotar el ID (ejemplo: ID=5)</li>
<li>Logout</li>
<li>Login como <code>maria@gmail.com</code> â†’ password: <code>admin123</code></li>
<li>Ir a <code>/parcels/5/edit</code> (IDOR - A01)</li>
<li>Cambiar nombre a &quot;Parcela Hackeada&quot; o eliminarla</li>
<li><strong>Resultado:</strong> âŒ No hay registro de quiÃ©n lo hizo, cuÃ¡ndo, ni valores anteriores</li>
</ol>
<p><strong>Verificar falta de logs:</strong></p>
<pre class="hljs"><code><div>php artisan tinker
</div></code></pre>
<pre class="hljs"><code><div>&gt;&gt;&gt; DB::getSchemaBuilder()-&gt;getTables();
<span class="hljs-comment">// No existe tabla "audit_logs" o "activity_log"</span>

&gt;&gt;&gt; Parcel::withTrashed()-&gt;find(<span class="hljs-number">5</span>);
<span class="hljs-comment">// Si fue eliminada: null</span>
<span class="hljs-comment">// Sin soft deletes, el dato se pierde para siempre</span>

&gt;&gt;&gt; <span class="hljs-comment">// No hay forma de saber:</span>
<span class="hljs-comment">// - QuiÃ©n eliminÃ³ la parcela</span>
<span class="hljs-comment">// - CuÃ¡ndo se eliminÃ³</span>
<span class="hljs-comment">// - QuÃ© datos contenÃ­a</span>
<span class="hljs-comment">// - Por quÃ© se eliminÃ³</span>
</div></code></pre>
<p><strong>DemostraciÃ³n visual:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Ver logs del sistema</span>
tail -f storage/logs/laravel.log

<span class="hljs-comment"># 2. Eliminar una parcela desde la interfaz</span>

<span class="hljs-comment"># 3. Observar el log:</span>
<span class="hljs-comment"># - NO aparece registro de eliminaciÃ³n</span>
<span class="hljs-comment"># - NO hay user_id del actor</span>
<span class="hljs-comment"># - NO hay IP address</span>
<span class="hljs-comment"># - NO hay valores eliminados</span>
</div></code></pre>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// 1. Crear tabla de auditorÃ­a (migration)</span>
Schema::create(<span class="hljs-string">'audit_logs'</span>, <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-params">(Blueprint $table)</span> </span>{
    $table-&gt;id();
    $table-&gt;foreignId(<span class="hljs-string">'user_id'</span>)-&gt;constrained();
    $table-&gt;string(<span class="hljs-string">'action'</span>); <span class="hljs-comment">// 'create', 'update', 'delete', 'view'</span>
    $table-&gt;string(<span class="hljs-string">'model'</span>); <span class="hljs-comment">// 'Parcel', 'Producto', etc.</span>
    $table-&gt;unsignedBigInteger(<span class="hljs-string">'model_id'</span>);
    $table-&gt;json(<span class="hljs-string">'old_values'</span>)-&gt;nullable();
    $table-&gt;json(<span class="hljs-string">'new_values'</span>)-&gt;nullable();
    $table-&gt;ipAddress(<span class="hljs-string">'ip_address'</span>);
    $table-&gt;string(<span class="hljs-string">'user_agent'</span>)-&gt;nullable();
    $table-&gt;timestamps();
});

<span class="hljs-comment">// 2. Registrar cada acciÃ³n importante</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Support</span>\<span class="hljs-title">Facades</span>\<span class="hljs-title">Log</span>;

<span class="hljs-keyword">public</span> <span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">update</span><span class="hljs-params">(Request $request, $id)</span>
</span>{
    $parcel = Parcel::findOrFail($id);
    $oldValues = $parcel-&gt;toArray();
    
    $parcel-&gt;update($request-&gt;all());
    
    <span class="hljs-comment">// âœ… Registrar cambio</span>
    AuditLog::create([
        <span class="hljs-string">'user_id'</span> =&gt; auth()-&gt;id(),
        <span class="hljs-string">'action'</span> =&gt; <span class="hljs-string">'update'</span>,
        <span class="hljs-string">'model'</span> =&gt; <span class="hljs-string">'Parcel'</span>,
        <span class="hljs-string">'model_id'</span> =&gt; $id,
        <span class="hljs-string">'old_values'</span> =&gt; $oldValues,
        <span class="hljs-string">'new_values'</span> =&gt; $parcel-&gt;fresh()-&gt;toArray(),
        <span class="hljs-string">'ip_address'</span> =&gt; $request-&gt;ip(),
        <span class="hljs-string">'user_agent'</span> =&gt; $request-&gt;userAgent(),
    ]);
    
    Log::info(<span class="hljs-string">'Parcel updated'</span>, [
        <span class="hljs-string">'user_id'</span> =&gt; auth()-&gt;id(),
        <span class="hljs-string">'parcel_id'</span> =&gt; $id,
        <span class="hljs-string">'ip'</span> =&gt; $request-&gt;ip(),
        <span class="hljs-string">'changes'</span> =&gt; $parcel-&gt;getChanges(),
    ]);
}

<span class="hljs-comment">// 3. Usar Soft Deletes para recuperaciÃ³n</span>
<span class="hljs-keyword">use</span> <span class="hljs-title">Illuminate</span>\<span class="hljs-title">Database</span>\<span class="hljs-title">Eloquent</span>\<span class="hljs-title">SoftDeletes</span>;

<span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">Parcel</span> <span class="hljs-keyword">extends</span> <span class="hljs-title">Model</span>
</span>{
    <span class="hljs-keyword">use</span> <span class="hljs-title">SoftDeletes</span>; <span class="hljs-comment">// Permite recuperar datos "eliminados"</span>
}

<span class="hljs-comment">// 4. Monitorear actividad sospechosa</span>
$suspiciousDeletes = AuditLog::where(<span class="hljs-string">'created_at'</span>, <span class="hljs-string">'&gt;'</span>, now()-&gt;subHour())
    -&gt;where(<span class="hljs-string">'action'</span>, <span class="hljs-string">'delete'</span>)
    -&gt;count();
    
<span class="hljs-keyword">if</span> ($suspiciousDeletes &gt; <span class="hljs-number">10</span>) {
    <span class="hljs-comment">// Alertar administradores</span>
    Mail::to(<span class="hljs-string">'admin@example.com'</span>)-&gt;send(<span class="hljs-keyword">new</span> SecurityAlert());
}
</div></code></pre>
<hr>
<h3 id="6-%F0%9F%94%B4-sql-injection-sqli---a032021">6. ğŸ”´ <strong>SQL Injection (SQLi)</strong> - A03:2021</h3>
<p><strong>UbicaciÃ³n:</strong> <code>app/Http/Controllers/ProductoController.php</code> - LÃ­nea 15</p>
<p><strong>DescripciÃ³n:</strong><br>
La bÃºsqueda de productos concatena directamente la entrada del usuario en la consulta SQL sin usar parÃ¡metros preparados.</p>
<p><strong>CÃ³digo vulnerable:</strong></p>
<pre class="hljs"><code><div>$busqueda = $request-&gt;input(<span class="hljs-string">'buscar'</span>, <span class="hljs-string">''</span>);
$productos = DB::select(<span class="hljs-string">"SELECT * FROM productos WHERE nombre LIKE '%$busqueda%'"</span>);
</div></code></pre>
<p><strong>Impacto:</strong></p>
<ul>
<li>âš ï¸ Acceso no autorizado a toda la base de datos</li>
<li>âš ï¸ ExtracciÃ³n de informaciÃ³n sensible</li>
<li>âš ï¸ ModificaciÃ³n o eliminaciÃ³n de datos</li>
<li>âš ï¸ En casos extremos: compromiso total del servidor</li>
</ul>
<p><strong>CÃ³mo explotarlo:</strong></p>
<ol>
<li>Ve a <code>/productos</code></li>
<li>En el campo de bÃºsqueda, ingresa: <code>' OR '1'='1</code></li>
<li>Resultado: Muestra todos los productos sin filtro</li>
</ol>
<p><strong>Payload de prueba:</strong></p>
<pre class="hljs"><code><div>' OR '1'='1
' UNION <span class="hljs-keyword">SELECT</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,<span class="hljs-number">3</span>,<span class="hljs-number">4</span>,<span class="hljs-number">5</span><span class="hljs-comment">--</span>
<span class="hljs-string">'; DROP TABLE productos; --
</span></div></code></pre>
<p><strong>SoluciÃ³n correcta:</strong></p>
<pre class="hljs"><code><div><span class="hljs-comment">// Usar parÃ¡metros preparados</span>
$productos = DB::select(<span class="hljs-string">"SELECT * FROM productos WHERE nombre LIKE ?"</span>, [<span class="hljs-string">"%$busqueda%"</span>]);
<span class="hljs-comment">// O mejor aÃºn, usar Eloquent:</span>
$productos = Producto::where(<span class="hljs-string">'nombre'</span>, <span class="hljs-string">'like'</span>, <span class="hljs-string">"%$busqueda%"</span>)-&gt;get();
</div></code></pre>
<hr>
<h2 id="%F0%9F%93%81-estructura-del-proyecto">ğŸ“ Estructura del Proyecto</h2>
<pre class="hljs"><code><div>Proyecto-Seguridad-TI/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ Http/
â”‚   â”‚   â””â”€â”€ Controllers/
â”‚   â”‚       â”œâ”€â”€ ParcelController.php      # ğŸ”´ IDOR + A09 Logging Failure
â”‚   â”‚       â”œâ”€â”€ ProductoController.php    # ğŸ”´ SQLi + XSS vulnerable
â”‚   â”‚       â””â”€â”€ PruebaController.php
â”‚   â””â”€â”€ Models/
â”‚       â”œâ”€â”€ Parcel.php
â”‚       â”œâ”€â”€ Producto.php
â”‚       â””â”€â”€ User.php
â”œâ”€â”€ database/
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â”œâ”€â”€ 2025_10_24_023752_create_parcels_table.php
â”‚   â”‚   â””â”€â”€ 2025_10_24_024343_create_productos_table.php
â”‚   â””â”€â”€ seeders/
â”‚       â””â”€â”€ DemoSeeder.php
â”œâ”€â”€ resources/
â”‚   â””â”€â”€ views/
â”‚       â”œâ”€â”€ layouts/
â”‚       â”‚   â””â”€â”€ app.blade.php             # Layout principal
â”‚       â”œâ”€â”€ demo/
â”‚       â”‚   â”œâ”€â”€ login.blade.php           # ğŸ”´ Auth dÃ©bil
â”‚       â”‚   â””â”€â”€ register.blade.php
â”‚       â”œâ”€â”€ parcels/
â”‚       â”‚   â”œâ”€â”€ index.blade.php           # Con botÃ³n eliminar (A09)
â”‚       â”‚   â”œâ”€â”€ create.blade.php
â”‚       â”‚   â”œâ”€â”€ edit.blade.php            # ğŸ”´ IDOR
â”‚       â”‚   â””â”€â”€ show.blade.php
â”‚       â”œâ”€â”€ productos/
â”‚       â”‚   â”œâ”€â”€ index.blade.php           # ğŸ”´ XSS
â”‚       â”‚   â””â”€â”€ create.blade.php
â”‚       â””â”€â”€ dashboard.blade.php
â”œâ”€â”€ routes/
â”‚   â””â”€â”€ web.php                           # ğŸ”´ Todas las rutas vulnerables
â”œâ”€â”€ .env                                  # ğŸ”´ Misconfig
â””â”€â”€ README.md
</div></code></pre>
<hr>
<h2 id="%F0%9F%8E%AE-uso-y-demostraci%C3%B3n">ğŸ® Uso y DemostraciÃ³n</h2>
<h3 id="rutas-principales">Rutas principales:</h3>
<table>
<thead>
<tr>
<th>Ruta</th>
<th>DescripciÃ³n</th>
<th>Vulnerabilidad</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>/login</code></td>
<td>PÃ¡gina de login</td>
<td>A07 - Auth dÃ©bil</td>
</tr>
<tr>
<td><code>/dashboard</code></td>
<td>Dashboard principal</td>
<td>-</td>
</tr>
<tr>
<td><code>/parcels</code></td>
<td>Listado de parcelas</td>
<td>-</td>
</tr>
<tr>
<td><code>/parcels/create</code></td>
<td>Crear nueva parcela</td>
<td>-</td>
</tr>
<tr>
<td><code>/parcels/{id}/edit</code></td>
<td>Editar parcela</td>
<td>A01 - IDOR</td>
</tr>
<tr>
<td><code>/parcels/{id}</code> (DELETE)</td>
<td>Eliminar parcela</td>
<td>A09 - No logs</td>
</tr>
<tr>
<td><code>/productos</code></td>
<td>Listado de productos</td>
<td>A03 - SQLi</td>
</tr>
<tr>
<td><code>/productos/crear</code></td>
<td>Crear producto</td>
<td>A03 - XSS</td>
</tr>
<tr>
<td><code>/demo/leak-env</code></td>
<td>Expone .env</td>
<td>A05 - Misconfig</td>
</tr>
<tr>
<td><code>/demo-login</code></td>
<td>Login vulnerable</td>
<td>A07 - Auth</td>
</tr>
<tr>
<td><code>/demo-reset-request</code></td>
<td>Reset token</td>
<td>A07 - Token predecible</td>
</tr>
</tbody>
</table>
<h3 id="demostraci%C3%B3n-paso-a-paso">DemostraciÃ³n paso a paso:</h3>
<h4 id="1-sql-injection-a03">1. SQL Injection (A03)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Accede a http://127.0.0.1:8000/productos</span>
<span class="hljs-comment"># 2. En la bÃºsqueda, ingresa: ' OR '1'='1</span>
<span class="hljs-comment"># 3. Resultado: Muestra todos los productos sin filtro</span>
<span class="hljs-comment"># 4. Prueba tambiÃ©n: '; DROP TABLE productos; --</span>
</div></code></pre>
<h4 id="2-xss-a03">2. XSS (A03)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Accede a /productos/crear</span>
<span class="hljs-comment"># 2. Nombre: Producto Test</span>
<span class="hljs-comment"># 3. DescripciÃ³n: &lt;script&gt;alert('XSS Vulnerable!')&lt;/script&gt;</span>
<span class="hljs-comment"># 4. Precio: 100</span>
<span class="hljs-comment"># 5. Guarda y ve la lista</span>
<span class="hljs-comment"># 6. Resultado: El script se ejecuta mostrando la alerta</span>
</div></code></pre>
<h4 id="3-idor---broken-access-control-a01">3. IDOR - Broken Access Control (A01)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Login como josue@gmail.com / admin123</span>
<span class="hljs-comment"># 2. Crear parcela "Mi Parcela Privada" (nota el ID, ej: 7)</span>
<span class="hljs-comment"># 3. Logout</span>
<span class="hljs-comment"># 4. Login como maria@gmail.com / admin123</span>
<span class="hljs-comment"># 5. Accede manualmente a: /parcels/7/edit</span>
<span class="hljs-comment"># 6. Resultado: Puedes ver y editar la parcela de Josue</span>
</div></code></pre>
<h4 id="4-broken-authentication-a07">4. Broken Authentication (A07)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Intenta login con cualquier email registrado</span>
<span class="hljs-comment"># 2. Password: admin123</span>
<span class="hljs-comment"># 3. Resultado: Acceso concedido sin validaciÃ³n real</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 4. Para token predecible:</span>
<span class="hljs-comment"># POST /demo-reset-request</span>
<span class="hljs-comment"># body: email=test@test.com</span>
<span class="hljs-comment"># Resultado: Muestra token predecible basado en md5(email+time)</span>
</div></code></pre>
<h4 id="5-security-logging-failure-a09">5. Security Logging Failure (A09)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># 1. Login como josue@gmail.com / admin123</span>
<span class="hljs-comment"># 2. Crear parcela "Parcela Importante"</span>
<span class="hljs-comment"># 3. Logout, login como maria@gmail.com / admin123</span>
<span class="hljs-comment"># 4. Ir a /parcels/X/edit (IDOR)</span>
<span class="hljs-comment"># 5. Eliminar la parcela</span>
<span class="hljs-comment"># 6. Verificar: php artisan tinker</span>
<span class="hljs-comment">#    &gt;&gt;&gt; DB::table('parcels')-&gt;where('id', X)-&gt;first()</span>
<span class="hljs-comment">#    &gt;&gt;&gt; // null - sin forma de recuperar</span>
<span class="hljs-comment">#    &gt;&gt;&gt; // Sin logs de quiÃ©n la eliminÃ³</span>
</div></code></pre>
<h4 id="6-security-misconfiguration-a05">6. Security Misconfiguration (A05)</h4>
<pre class="hljs"><code><div><span class="hljs-comment"># Con APP_DEBUG=true:</span>
<span class="hljs-comment"># 1. Accede a: /demo/leak-env</span>
<span class="hljs-comment"># Resultado: Muestra todo el contenido del archivo .env</span>
<span class="hljs-comment">#</span>
<span class="hljs-comment"># 2. Fuerza un error: /parcels/999999999</span>
<span class="hljs-comment"># Resultado: Stack trace completo con rutas, queries, versiones</span>
</div></code></pre>
<hr>
<h2 id="%E2%9A%A0%EF%B8%8F-advertencias">âš ï¸ Advertencias</h2>
<ul>
<li>âš ï¸ <strong>ESTE PROYECTO ES SOLO PARA FINES EDUCATIVOS</strong></li>
<li>âš ï¸ <strong>NO USAR EN PRODUCCIÃ“N</strong></li>
<li>âš ï¸ <strong>NO DESPLEGAR EN SERVIDORES PÃšBLICOS</strong></li>
<li>âš ï¸ Las vulnerabilidades son intencionales para demostraciÃ³n acadÃ©mica</li>
</ul>
<hr>
<h2 id="%F0%9F%93%9A-recursos-adicionales">ğŸ“š Recursos Adicionales</h2>
<ul>
<li><a href="https://owasp.org/Top10/">OWASP Top 10 2021</a></li>
<li><a href="https://laravel.com/docs/11.x/security">Laravel Security Best Practices</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/PHP_Configuration_Cheat_Sheet.html">PHP Security Cheat Sheet</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/SQL_Injection_Prevention_Cheat_Sheet.html">SQL Injection Prevention</a></li>
<li><a href="https://cheatsheetseries.owasp.org/cheatsheets/Cross_Site_Scripting_Prevention_Cheat_Sheet.html">XSS Prevention</a></li>
</ul>
<hr>
<h2 id="%F0%9F%93%8A-resumen-de-vulnerabilidades">ğŸ“Š Resumen de Vulnerabilidades</h2>
<table>
<thead>
<tr>
<th># OWASP</th>
<th>Vulnerabilidad</th>
<th>Implementada</th>
<th>UbicaciÃ³n</th>
<th>Impacto</th>
</tr>
</thead>
<tbody>
<tr>
<td>A03:2021</td>
<td>Injection (SQLi)</td>
<td>âœ…</td>
<td>ProductoController.php</td>
<td>CrÃ­tico</td>
</tr>
<tr>
<td>A03:2021</td>
<td>Injection (XSS)</td>
<td>âœ…</td>
<td>ProductoController.php</td>
<td>CrÃ­tico</td>
</tr>
<tr>
<td>A01:2021</td>
<td>Broken Access Control</td>
<td>âœ…</td>
<td>ParcelController.php</td>
<td>Alto</td>
</tr>
<tr>
<td>A07:2021</td>
<td>Authentication Failures</td>
<td>âœ…</td>
<td>routes/web.php</td>
<td>Alto</td>
</tr>
<tr>
<td>A10:2021</td>
<td>SSRF</td>
<td>âœ…</td>
<td>routes/web.php</td>
<td>Alto</td>
</tr>
<tr>
<td>A09:2021</td>
<td>Logging Failures</td>
<td>âœ…</td>
<td>ParcelController.php</td>
<td>Medio</td>
</tr>
<tr>
<td>A05:2021</td>
<td>Security Misconfiguration</td>
<td>âœ…</td>
<td>.env + routes/web.php</td>
<td>Medio</td>
</tr>
</tbody>
</table>
<p><strong>Total: 6 vulnerabilidades crÃ­ticas implementadas (7 incluyendo Misconfig)</strong></p>
<hr>
<h2 id="%F0%9F%9B%A0%EF%B8%8F-herramientas-de-testing">ğŸ› ï¸ Herramientas de Testing</h2>
<h3 id="para-probar-las-vulnerabilidades">Para probar las vulnerabilidades:</h3>
<pre class="hljs"><code><div><span class="hljs-comment"># SQL Injection</span>
sqlmap -u <span class="hljs-string">"http://127.0.0.1:8000/productos?buscar=test"</span> --dbs

<span class="hljs-comment"># AuditorÃ­a de composer</span>
composer audit

<span class="hljs-comment"># AnÃ¡lisis de cÃ³digo estÃ¡tico</span>
./vendor/bin/phpstan analyse app
</div></code></pre>
<hr>
<h2 id="%F0%9F%91%A5-cr%C3%A9ditos">ğŸ‘¥ CrÃ©ditos</h2>
<p><strong>Proyecto:</strong> Seguridad en TecnologÃ­as de la InformaciÃ³n<br>
<strong>InstituciÃ³n:</strong> Universidad Tecnica Nacional
<strong>AÃ±o:</strong> 2025</p>
<h3 id="autores">Autores:</h3>
<ul>
<li>Andrew Montero - <a href="https://github.com/AndrewMontero">@AndrewMontero</a></li>
<li>Deivis Jimenez - [@DeivisJm]</li>
</ul>
<h3 id="agradecimientos">Agradecimientos:</h3>
<ul>
<li>OWASP Foundation por la documentaciÃ³n del Top 10</li>
<li>Comunidad de Laravel por el framework</li>
<li>Profesores y compaÃ±eros del curso de Seguridad TI</li>
</ul>
<hr>
<h2 id="%F0%9F%93%84-licencia">ğŸ“„ Licencia</h2>
<p>Este proyecto es de uso educativo exclusivamente.</p>
<p><strong>MIT License</strong> - Ver archivo <code>LICENSE</code> para mÃ¡s detalles.</p>
<hr>
<h2 id="%F0%9F%A4%9D-contribuciones">ğŸ¤ Contribuciones</h2>
<p>Las contribuciones educativas son bienvenidas. Por favor:</p>
<ol>
<li>Fork el proyecto</li>
<li>Crea una rama (<code>git checkout -b feature/NuevaVulnerabilidad</code>)</li>
<li>Commit tus cambios (<code>git commit -m 'Agrega nueva vulnerabilidad educativa'</code>)</li>
<li>Push a la rama (<code>git push origin feature/NuevaVulnerabilidad</code>)</li>
<li>Abre un Pull Request</li>
</ol>
<h3 id="directrices">Directrices:</h3>
<ul>
<li>Documenta claramente cada vulnerabilidad</li>
<li>Incluye ejemplos de explotaciÃ³n</li>
<li>Proporciona la soluciÃ³n correcta</li>
<li>AÃ±ade referencias a OWASP</li>
</ul>
<hr>
<h2 id="%E2%9D%93-faq-preguntas-frecuentes">â“ FAQ (Preguntas Frecuentes)</h2>
<h3 id="%C2%BFes-seguro-ejecutar-este-proyecto">Â¿Es seguro ejecutar este proyecto?</h3>
<p>Solo en entorno local para aprendizaje. <strong>NUNCA</strong> en producciÃ³n o servidores pÃºblicos.</p>
<h3 id="%C2%BFc%C3%B3mo-resuelvo-el-error-%22419-page-expired%22">Â¿CÃ³mo resuelvo el error &quot;419 Page Expired&quot;?</h3>
<pre class="hljs"><code><div>php artisan config:clear
php artisan cache:clear
<span class="hljs-comment"># Borra cookies del navegador</span>
<span class="hljs-comment"># Reinicia php artisan serve</span>
</div></code></pre>
<h3 id="%C2%BFlas-vulnerabilidades-son-reales">Â¿Las vulnerabilidades son reales?</h3>
<p>SÃ­, todas estÃ¡n basadas en vulnerabilidades reales documentadas por OWASP. Son intencionalmente inseguras para fines educativos.</p>
<h3 id="%C2%BFpuedo-usar-este-proyecto-como-referencia">Â¿Puedo usar este proyecto como referencia?</h3>
<p>SÃ­, pero <strong>solo</strong> como ejemplo de quÃ© NO hacer. Ãšsalo para aprender a identificar y corregir vulnerabilidades.</p>
<h3 id="%C2%BFd%C3%B3nde-puedo-aprender-m%C3%A1s">Â¿DÃ³nde puedo aprender mÃ¡s?</h3>
<ul>
<li><a href="https://owasp.org/www-project-web-security-testing-guide/">OWASP Academy</a></li>
<li><a href="https://portswigger.net/web-security">PortSwigger Web Security Academy</a></li>
<li><a href="https://www.hackthebox.com/">HackTheBox</a></li>
</ul>
<hr>
<p>Â¿Preguntas sobre el proyecto?</p>
<ul>
<li><strong>GitHub Issues</strong>: <a href="https://github.com/AndrewMontero/Proyecto-Seguridad-TI/issues">Abrir issue</a></li>
<li><strong>Repositorio</strong>: https://github.com/AndrewMontero/Proyecto-Seguridad-TI</li>
</ul>
<hr>
<h2 id="%F0%9F%8E%AF-objetivos-de-aprendizaje">ğŸ¯ Objetivos de Aprendizaje</h2>
<p>Al completar este proyecto, habrÃ¡s aprendido:</p>
<p>âœ… Identificar las 6 vulnerabilidades mÃ¡s crÃ­ticas del OWASP Top 10<br>
âœ… Entender cÃ³mo los atacantes explotan cada vulnerabilidad<br>
âœ… Implementar cÃ³digo vulnerable de forma controlada<br>
âœ… Aplicar las soluciones correctas para mitigar riesgos<br>
âœ… Usar herramientas de testing de seguridad<br>
âœ… Documentar vulnerabilidades de forma clara</p>
<hr>
<h2 id="%F0%9F%93%9D-changelog">ğŸ“ Changelog</h2>
<h3 id="v100-2025-01-31">v1.0.0 (2025-01-31)</h3>
<ul>
<li>âœ… ImplementaciÃ³n inicial de 6 vulnerabilidades OWASP Top 10</li>
<li>âœ… Sistema completo de gestiÃ³n agrÃ­cola</li>
<li>âœ… Dashboard interactivo</li>
<li>âœ… DocumentaciÃ³n completa</li>
<li>âœ… Datos de prueba (seeders)</li>
</ul>
<hr>
<p><strong>ğŸ’» Desarrollado con propÃ³sitos educativos | ğŸ”’ Aprende Seguridad de forma prÃ¡ctica</strong></p>
<hr>

</body>
</html>
